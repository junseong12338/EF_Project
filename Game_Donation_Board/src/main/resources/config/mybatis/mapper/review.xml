<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="r">


	<select id="review_list" resultType="review">
		select * from ef_review order by review_idx DESC
	</select>
	
	<!-- 리뷰 단일 셀렉트 -->
	<select id="selectOne_review" parameterType="int" resultType="review">
		SELECT review_IDX,
			   project_idx,
		       USER_IDX,
		       review_CONTENT
	   FROM EF_review
	   WHERE user_IDX=#{user_idx}
	</select>
	
	
	<select id="user_img" resultType="string" parameterType="int">
	 select user_img from ef_user
	 where user_idx = #{user_idx}
	</select>
	
	<select id="user_name" resultType="string" parameterType="int">
	 select user_name from ef_user
	 where user_idx = #{user_idx}
	</select>
	
	 <select id="regdate" resultType="int" parameterType="int">
		 SELECT FLOOR((SYSDATE - REGDATE) * 86400) FROM EF_REVIEW WHERE REVIEW_IDX = #{review_idx}
	</select>
	
	<insert id="review_insert" parameterType="review">
	insert into ef_review values(
			EF_REVIEW_SEQ.nextval,
			#{project_idx},
			#{user_idx},
			#{review_content},
			SYSDATE
	)
	</insert>
	<delete id="review_delete" parameterType="int">
		DELETE FROM EF_review
		WHERE review_idx=#{review_idx}
	</delete>
	<!-- 현재 시간과 저장 시간의 날짜 차이를 확인 (소수점 이하 제외) -->
	<select id="day">
		SELECT review_idx, #{regdate}, TRUNC(SYSDATE-#{regdate})
		FROM  ef_review;
	</select>
	<!-- 현재 시간과 저장 시간의 개월 차이를 확인 -->
		<select id="month">
		SELECT review_idx, #{regdate}, TRUNC(MONTHS_BETWEEN(SYSDATE, #{regdate}))
		FROM   ef_review;
	</select>
</mapper>












