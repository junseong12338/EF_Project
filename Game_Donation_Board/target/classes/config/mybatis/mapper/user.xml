<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="u">

	<select id="checkEmail" resultType="user" parameterType="String">
		SELECT * FROM EF_USER WHERE USER_EMAIL =#{user_email}
	</select>
	
		<select id="checkSocial" resultType="user" parameterType="String">
		SELECT * FROM EF_USER WHERE user_social =#{user_social}
	</select>
	
   <insert id="insert" parameterType="user">
        INSERT INTO EF_USER VALUES (SEQ_EF_USER_IDX.NEXTVAL, 1, #{user_email}, #{user_name}, #{user_pw, jdbcType=VARCHAR} , '', 1, '', '', 0,#{user_social, jdbcType=VARCHAR})
   </insert>

	<!-- 포인트 업데이트  -->
	<update id="update_point" parameterType="int">
		 UPDATE EF_USER
        SET user_point = #{user_Point}
        WHERE user_id = #{user_Id}
	</update>
	
	
	<!-- 회원 탈퇴 -->
	<delete id="user_delete" parameterType="int">
		DELETE FROM EF_USER
		WHERE user_idx=#{user_idx}
	</delete>
	
	<!-- 주소지 등록 -->
	<update id ="update" parameterType="user">
		UPDATE EF_USER
		SET USER_ADDR=#{user_addr,jdbcType=VARCHAR}
		where user_email=#{user_email}
	</update>
	
	 <!-- EF_PROJECT 테이블에서 게시글을 페이징하여 가져옴 -->
	<select id="user_list" resultType="user" parameterType="java.util.HashMap"> 
		SELECT * FROM 
		(SELECT RANK() OVER(ORDER BY REF DESC, STEP) "no", b.* FROM EF_PROJECT b) 
		WHERE "no" BETWEEN #{start} AND #{end}
 	</select>

	<!-- 등록한 프로젝트 조회 -->
	<select id="user_count" parameterType="int"> 
	SELECT * FROM EF_PROJECT
    WHERE USER_IDX =#{userIdx}
	</select>
	
	<!-- 후원한 프로젝트 조회 -->
	<select id="donation_list" resultType="dto.DonationDTO">
	SELECT * FROM EF_DONATION
	</select>
</mapper>












